<!doctype html>
<html lang="en">
	<head>
  
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta property="og:title" content="Shader Editor" />
		<meta property="og:description" content="Ce site a pour objectif de référencer des fonctions basiques utilisables dans les shaders" />
		<meta property="og:image" content="https://niwala.github.io/media/banner.jpg" />
		<meta property="og:url" content="https://niwala.github.io/" />
		
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:title" content="Shader Editor">
		<meta name="twitter:description" content="Ce site a pour objectif de référencer des fonctions basiques utilisables dans les shaders">
		<meta name="twitter:image" content="https://niwala.github.io/media/banner.jpg">
		
		<title>Shader Editor</title>
		<link rel="icon" href="./src/shader-library/favicon.ico" type="image/x-icon">

		<link rel="stylesheet" href="./src/shader-library/external/coloris/coloris.css" type="text/css"/>
		<script src="./src/shader-library/external/coloris/coloris.js"></script>
		
		<link rel="stylesheet" href="./src/shader-library/styles/layout.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/ace-styles.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/editor.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/field-styles.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/styles.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/switch-buttons.css" type="text/css"/>
		<link rel="stylesheet" href="./src/shader-library/styles/notion-styles.css" type="text/css"/>
		
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
		
		<!-- WebM -->
		<script src="./src/shader-library/scripts/WebM/BlobBuffer.js"></script>
		<script src="./src/shader-library/scripts/WebM/ArrayBufferDataStream.js"></script>
		<script src="./src/shader-library/scripts/WebM/WebMWriter.js"></script>


		<script type="module" src="./src/shader-library/scripts/exporter.js"></script>

		<script src="./src/shader-library/external/ace/ace.js"></script>
		<script src="./src/shader-library/external/ace/ext-language_tools.js"></script>
		<script src="./src/shader-library/scripts/packer.js"></script>
		<script src="./src/shader-library/scripts/notion-reader.js"></script>
		<script src="./src/shader-library/scripts/gl-matrix-min.js" defer></script>
		<script src="./src/shader-library/scripts/renderer.js" defer></script>
		<script src="./src/shader-library/scripts/function-structs.js" defer></script>
		<script src="./src/shader-library/scripts/editor.js" defer></script>
	
	</head>

  <body>


	<!-- Overlay Canvas --> 
	<canvas width="1024" height="1024" id="overlay-canvas" class="overlay-canvas"></canvas>


	<!-- Context menu -->
	<div id="menu" class="context-menu">
	<button onclick="ContextMenuAction('Copy')">Copy shader code</button>
	<button onclick="ContextMenuAction('Open')">Open in editor</button>
	</div>
  

	<!-- Popup panel-->
	<div id="popup-panel">
	
		<!-- Layout -->
		<div id="layout-section" class="vertical" style="display: none;">
			<div class="popup-panel-header">Editor layout</div>
			<div class="horizontal"><button class="img-button" onclick="SetWindowsLayout('layout-a')"><img class="icon" src="./src/shader-library/media/layout-code-vertical.png"></button><span class="button-side-label">Vertical</span></div>
			<div class="horizontal"><button class="img-button" onclick="SetWindowsLayout('layout-b')"><img class="icon" src="./src/shader-library/media/layout-code-horizontal.png"></button><span class="button-side-label">Horizontal</span></div>
			<div class="horizontal"><button class="img-button" onclick="SetWindowsLayout('layout-c')"><img class="icon" src="./src/shader-library/media/layout-code-stack.png"></button><span class="button-side-label">Stack</span></div>
		</div>

		<!-- Info -->
		<div id="info-section" class="vertical" style="display: none;">
			<div class="popup-panel-header">Shader info</div>
			<span>The code executed is GLSL, but for the sake of comfort and educational demonstrations, the editor is compatible with most HLSL keywords.</span>
			<div class="separator"></div>
			<span><b>Uniforms :</b> time, screenSize, mousePosition</span>
			<span><b>Constants :</b> PI, TAU</span>
			<span><b>Functions :</b> noise12, smin, rotate, hash11, hash12, hash22, ...</span>
			<div class="separator"></div>
			<lu>
				<li>uv.xy : Layout Uvs</li>
				<li>uv.zw : Normalized Uvs</li>
			</lu>
			<div class="separator"></div>
			<div><b>Attributes</b></div>
			<span>You can specify attributes to create fields exposed to users. You must always specify a default value.
				<lu>
					<li>[Range(default, min, max)]</li>
					<li>[Float(default)]</li>
					<li>[Toggle(default)]</li>
					<li>[Color(#rrggbbaa)] / [Color(r, g, b, a)]</li>
					<li>[Enum(default (int), choice0, choice1, choice2, ...)]</li>
					<li>[Vector(x, y, z, w)]</li>
				</lu>
			</span>
		</div>

		<!-- Examples -->
		<div id="examples-section" class="vertical" style="display: none;">
			<div class="popup-panel-header" id="examples-btn-list">Examples</div>
			<button onclick="OpenExample('default')">Default</button>
			<button onclick="OpenExample('properties')">Properties</button>
			<button onclick="OpenExample('mask')">Mask</button>
			<button onclick="OpenExample('raymarching')">Raymarching</button>
			<button onclick="OpenExample('mouse')">Mouse</button>
			<button onclick="OpenExample('layout-check')">Layout Check</button>
		</div>

		<!-- Export Properties -->
		<div class="export-properties vertical" id="export-section"  style="flex-grow: 1;">
			<div class="popup-panel-header">Export settings</div>

			 <h3>IFrame</h3>

			<!-- Shader Only -->
			<div class='shader-property' style="flex-grow: 0;">
				<p style='user-select: none; cursor: pointer;' class="settings-label" onmousedown='SwitchToggle("shader-only-toggle")'>Shader Only</p>
				<label class="toggle-container">
					<input type="checkbox" onchange="SetShaderOnly(this)" id='shader-only-toggle'>
					<span class="checkmark"></span>
				</label>
			</div>

			<!-- Shader properties -->
			<div class='shader-property' style="opacity: 0.4;">
				<p style='user-select: none;' class="settings-label">Properties position</p>
				<select class='dropdown-field' onchange='SetDropdownValue(this)' id='properties-position'>
					<option value='0' selected>Left</option>
					<option value='1'>Right</option>
					<option value='2'>Top</option>
					<option value='3'>Bottom</option>
				</select>
			</div>


			<!-- Uv alignement -->
			 <div class="horizontal">
				<div class='shader-property' style="height: auto;">
					<p style='user-select: none;' class="settings-label">Uv alignement</p>

					<div class="vertical" style="margin-left: -5px;">
						<div class="horizontal">
							<button class="img-button" onclick="SetLayout(this, 17)" id = "layout-btn-17"><img class="icon" src="./src/shader-library/media/layout-left_top.png"></button>
							<button class="img-button" onclick="SetLayout(this, 18)" id = "layout-btn-18"><img class="icon" src="./src/shader-library/media/layout-mid_top.png"></button>
							<button class="img-button" onclick="SetLayout(this, 20)" id = "layout-btn-20"><img class="icon" src="./src/shader-library/media/layout-right_top.png"></button>
						</div>
						<div class="horizontal">
							<button class="img-button" onclick="SetLayout(this, 9)" id = "layout-btn-9"><img class="icon" src="./src/shader-library/media/layout-left_mid.png"></button>
							<button class="img-button" onclick="SetLayout(this, 10)" id = "layout-btn-10"><img class="icon" src="./src/shader-library/media/layout-center.png"></button>
							<button class="img-button" onclick="SetLayout(this, 12)" id = "layout-btn-12"><img class="icon" src="./src/shader-library/media/layout-right_mid.png"></button>
						</div>
						<div class="horizontal">
							<button class="img-button" onclick="SetLayout(this, 1)" id = "layout-btn-1"><img class="icon" src="./src/shader-library/media/layout-left_bot.png"></button>
							<button class="img-button" onclick="SetLayout(this, 2)" id = "layout-btn-2"><img class="icon" src="./src/shader-library/media/layout-mid_bot.png"></button>
							<button class="img-button" onclick="SetLayout(this, 4)" id = "layout-btn-4"><img class="icon" src="./src/shader-library/media/layout-right_bot.png"></button>
						</div>
					</div>
				</div>
			</div>
			<!-- <p>Clamp to square</p> -->

			<button onclick="ExportIFrame()" class="controls-full">Export iFrame</button>

			<div style="margin-top: 10px;"></div>
			<h3>Static</h3>

			<!-- Size -->
			<div class="horizontal">
				<label for="export-width" class="settings-label">Width</label>
				<input class="float-field" style="max-width: 40px; margin-right: 20px;" type="number" step="0.01" id="export-width" value="256" onchange="LoadExportSettings()">
			</div>
			
			<div class="horizontal">
				<label for="export-height" class="settings-label">Height</label>
				<input class="float-field" style="max-width: 40px;" type="number" step="0.01" id="export-height" value="256" onchange="LoadExportSettings()">
			</div>
							
			<button onclick="ExportPNG()" class="controls-full">Export PNG</button>

			<!-- Start time -->
			<div class="horizontal">
				<label for="export-start-time" class="settings-label">Start time</label>
				<input class="float-field" style="max-width: 40px; margin-right: 20px;" type="number" step="0.01" id="export-start-time" value="0.0" onchange="LoadExportSettings()">
			</div>

			<!-- Duration -->
			<div class="horizontal">
				<label for="export-duration" class="settings-label">Duration</label>
				<input class="float-field" style="max-width: 40px; margin-right: 20px;" type="number" step="0.01" id="export-duration" value="1.0" onchange="LoadExportSettings()">
			</div>

			<!-- FPS -->
			<div class="horizontal">
				<label for="export-fps" class="settings-label">FPS</label>
				<input class="float-field" style="max-width: 40px; margin-right: 20px;" type="number" step="0.01" id="export-fps" value="60" onchange="LoadExportSettings()">
			</div>
			<button onclick="ExportGIF()" class="controls-full">Export GIF</button>
			<button onclick="ExportWebM()" class="controls-full">Export WebM</button>
		</div>

	</div>


	<!-- Layout -->
	<div id="layout-root">
		<div id="layout" class="layout-normal">

			<!-- Code -->
			<div id="winA" class="panel panel-a"><div id="code-container" class="ace-host"><div id="ace-editor"></div></div></div>

			<!-- Shader Properties -->
			<div id="winB" class="panel panel-b"><div id="shader-properties" class="shader-properties"></div></div>

			<!-- Canvas -->
			<div id="winC" class="panel panel-c"><canvas id="shader-canvas" width="700" height="400" class="shader-editor-preview" style="align-self: start;"></canvas></div>

			<!-- Banner -->
			<div id="winD" class="panel panel-d">

				<!-- Background -->
				<div id="banner">

					<!-- Logo -->
					<div class="logo-area">
					
						<button class="transparent-button" onclick="GoToLibrary(event)" onauxclick="GoToLibrary(event)"></button>

							<!-- Sam's Backpack logo -->
							<div>
								<a href="https://niwala.github.io/"><div class="main-logo"></div></a>
							</div>
							
							<!-- Home button -->
							<div class="banner-titles">
								<h2 class="main-header" style="margin-bottom: -20px;">Sam's Backpack</h2>
								<h1 class="main-header">Shader Editor</h1>
							</div>
						</button>
					</div>	

					<!-- Controls -->
					<div class="controls-area">
						<div class="spacer" style="flex-grow: 1;"></div>

						<button onclick="ToggleLayoutPanel(this)" class="img-button controls-first"><img class="icon" src="./src/shader-library/media/layout-code-vertical.png"></button>
						<button onclick="ToggleInfoPanel(this)">Info</button>
						<button onclick="ToggleExamplesPanel(this)">Examples</button>
						<button onclick="ToggleExportPanel(this)" class="controls-last">Export</button>
					</div>

				</div>
			</div>

		</div>
	</div>


  </body>
</html>